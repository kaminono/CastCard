# é¡¹ç›®ç»“æ„ | Project Structure

## ğŸ“ ç›®å½•ç»“æ„

```
CastCard/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ globals.css          # å…¨å±€æ ·å¼ï¼ˆCSS å˜é‡ã€ä¸»é¢˜ï¼‰
â”‚   â”‚   â”œâ”€â”€ layout.tsx           # æ ¹å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ page.tsx             # é¦–é¡µï¼ˆä¸»åº”ç”¨é€»è¾‘ï¼‰
â”‚   â”‚   â””â”€â”€ page.css             # é¦–é¡µæ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ components/               # UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Header.tsx           # é¡µå¤´ï¼ˆå“ç‰Œã€è¯­è¨€åˆ‡æ¢ã€ä¸»é¢˜åˆ‡æ¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ Header.css
â”‚   â”‚   â”œâ”€â”€ Footer.tsx           # é¡µè„šï¼ˆæ¸…é™¤æ•°æ®ã€å…è´£å£°æ˜ï¼‰
â”‚   â”‚   â”œâ”€â”€ Footer.css
â”‚   â”‚   â”œâ”€â”€ ConnectionSection.tsx    # è¿æ¥åŒºï¼ˆAPI Keyã€Device IDã€æ¢æ´»ï¼‰
â”‚   â”‚   â”œâ”€â”€ ConnectionSection.css
â”‚   â”‚   â”œâ”€â”€ TextSection.tsx      # æ–‡æœ¬åŒºï¼ˆæ ‡é¢˜ã€å†…å®¹ã€ç­¾åã€å¼€å…³ï¼‰
â”‚   â”‚   â”œâ”€â”€ OperationSection.tsx # æ“ä½œåŒºï¼ˆå‘é€æŒ‰é’®ã€é€Ÿç‡æç¤ºï¼‰
â”‚   â”‚   â”œâ”€â”€ OperationSection.css
â”‚   â”‚   â”œâ”€â”€ ResponseSection.tsx  # å›æ‰§åŒºï¼ˆå“åº”æ˜¾ç¤ºã€é”™è¯¯å¤„ç†ï¼‰
â”‚   â”‚   â””â”€â”€ ResponseSection.css
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                    # è‡ªå®šä¹‰ React Hooks
â”‚   â”‚   â”œâ”€â”€ useI18n.ts           # å›½é™…åŒ– Hookï¼ˆè¯­è¨€åˆ‡æ¢ã€ç¿»è¯‘å‡½æ•°ï¼‰
â”‚   â”‚   â””â”€â”€ useTheme.ts          # ä¸»é¢˜ Hookï¼ˆäº®/æš—/ç³»ç»Ÿä¸»é¢˜ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ locales/                  # å›½é™…åŒ–è¯å…¸
â”‚   â”‚   â”œâ”€â”€ zh-CN.json           # ç®€ä½“ä¸­æ–‡è¯å…¸
â”‚   â”‚   â””â”€â”€ en-US.json           # è‹±æ–‡è¯å…¸
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ api.ts               # Dot API è°ƒç”¨å°è£…
â”‚       â”œâ”€â”€ storage.ts           # sessionStorage ç®¡ç†
â”‚       â””â”€â”€ rateLimit.ts         # é€Ÿç‡é™åˆ¶æ§åˆ¶
â”‚
â”œâ”€â”€ public/                       # é™æ€èµ„æºï¼ˆå›¾æ ‡ç­‰ï¼‰
â”‚
â”œâ”€â”€ out/                          # æ„å»ºè¾“å‡ºç›®å½•ï¼ˆç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ next.config.js               # Next.js é…ç½®ï¼ˆé™æ€å¯¼å‡ºï¼‰
â”œâ”€â”€ tsconfig.json                # TypeScript é…ç½®
â”œâ”€â”€ package.json                 # é¡¹ç›®ä¾èµ–
â”‚
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ PRIVACY.md                   # éšç§æ”¿ç­–
â”œâ”€â”€ TESTING.md                   # æµ‹è¯•æŒ‡å—
â”œâ”€â”€ CONTRIBUTING.md              # è´¡çŒ®æŒ‡å—
â”œâ”€â”€ PROJECT_STRUCTURE.md         # æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ LICENSE                      # MIT è®¸å¯è¯
â”œâ”€â”€ .gitignore                   # Git å¿½ç•¥è§„åˆ™
â”œâ”€â”€ .prettierrc.json            # ä»£ç æ ¼å¼åŒ–é…ç½®
â””â”€â”€ .eslintrc.json              # ä»£ç æ£€æŸ¥é…ç½®
```

## ğŸ“¦ æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. åº”ç”¨å…¥å£ (`src/app/`)

#### `layout.tsx`
- æ ¹å¸ƒå±€ç»„ä»¶
- å®šä¹‰ HTML ç»“æ„å’Œ metadata
- å…¨å±€åªåŠ è½½ä¸€æ¬¡

#### `page.tsx` â­ æ ¸å¿ƒ
- ä¸»åº”ç”¨é€»è¾‘
- çŠ¶æ€ç®¡ç†ï¼ˆè¿æ¥ã€æ–‡æœ¬ã€æ“ä½œã€å›æ‰§ï¼‰
- äº‹ä»¶å¤„ç†ï¼ˆæ¢æ´»ã€å‘é€ã€æ¸…é™¤ï¼‰
- ç»„ä»¶ç»„è£…

#### `globals.css`
- CSS å˜é‡å®šä¹‰ï¼ˆé¢œè‰²ã€åœ†è§’ã€é—´è·ï¼‰
- äº®è‰²/æš—è‰²ä¸»é¢˜å˜é‡
- å…¨å±€æ ·å¼ï¼ˆresetã€åŸºç¡€å…ƒç´ æ ·å¼ï¼‰
- é€šç”¨ç±»åï¼ˆ.btn, .card, .status-indicator ç­‰ï¼‰

### 2. UI ç»„ä»¶ (`src/components/`)

æ‰€æœ‰ç»„ä»¶éƒ½æ˜¯**å®¢æˆ·ç«¯ç»„ä»¶**ï¼ˆ'use client'ï¼‰ï¼Œæ”¯æŒäº¤äº’ã€‚

#### ç»„ä»¶èŒè´£åˆ’åˆ†

| ç»„ä»¶ | èŒè´£ | çŠ¶æ€ |
|------|------|------|
| `Header` | é¡µå¤´ã€å“ç‰Œå±•ç¤ºã€åˆ‡æ¢å™¨ | æ— çŠ¶æ€ï¼ˆä½¿ç”¨ Hooksï¼‰ |
| `Footer` | é¡µè„šã€æ¸…é™¤æ•°æ® | æ— çŠ¶æ€ï¼ˆæ¥æ”¶å›è°ƒï¼‰ |
| `ConnectionSection` | è¿æ¥é…ç½®ã€æ¢æ´» | æ— çŠ¶æ€ï¼ˆå—æ§ç»„ä»¶ï¼‰ |
| `TextSection` | æ–‡æœ¬è¾“å…¥è¡¨å• | æ— çŠ¶æ€ï¼ˆå—æ§ç»„ä»¶ï¼‰ |
| `OperationSection` | å‘é€æ“ä½œ | æ— çŠ¶æ€ï¼ˆå—æ§ç»„ä»¶ï¼‰ |
| `ResponseSection` | å“åº”å±•ç¤º | æ— çŠ¶æ€ï¼ˆçº¯å±•ç¤ºï¼‰ |

æ‰€æœ‰çŠ¶æ€ç”± `page.tsx` é›†ä¸­ç®¡ç†ï¼Œç»„ä»¶é€šè¿‡ props æ¥æ”¶æ•°æ®å’Œå›è°ƒã€‚

### 3. Hooks (`src/hooks/`)

#### `useI18n.ts`
```typescript
// åŠŸèƒ½
- è·å–/è®¾ç½®å½“å‰è¯­è¨€ï¼ˆzh-CN / en-USï¼‰
- æä¾›ç¿»è¯‘å‡½æ•° t(key, params?)
- è‡ªåŠ¨æ£€æµ‹æµè§ˆå™¨è¯­è¨€
- sessionStorage æŒä¹…åŒ–

// ä½¿ç”¨
const { locale, setLocale, t } = useI18n()
t('app.title')  // "CastCard Â· å¢¨æŠ•"
t('toast.rateLimitWait', { seconds: '3' })  // "é€Ÿç‡é™åˆ¶: è¯·ç­‰å¾… 3 ç§’"
```

#### `useTheme.ts`
```typescript
// åŠŸèƒ½
- è·å–/è®¾ç½®ä¸»é¢˜ï¼ˆlight / dark / systemï¼‰
- ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–
- è‡ªåŠ¨åº”ç”¨ CSS å˜é‡åˆ° DOM
- sessionStorage æŒä¹…åŒ–

// ä½¿ç”¨
const { theme, setTheme, resolvedTheme } = useTheme()
```

### 4. å·¥å…·å‡½æ•° (`src/utils/`)

#### `api.ts`
```typescript
// Dot Text API å°è£…
sendTextApi(apiKey, payload)  // å‘é€æ–‡æœ¬
probeDevice(apiKey, deviceId)  // æ¢æ´»ï¼ˆrefreshNow=falseï¼‰

// é”™è¯¯å¤„ç†
interface ApiError {
  status: number      // HTTP çŠ¶æ€ç 
  code: number        // ä¸šåŠ¡é”™è¯¯ç 
  message: string     // é”™è¯¯æ¶ˆæ¯
  fullResponse?: any  // å®Œæ•´å“åº”
}
```

#### `storage.ts`
```typescript
// sessionStorage ç®¡ç†
getStoredApiKey() / setStoredApiKey(key)
getStoredDeviceId() / setStoredDeviceId(id)
clearAllStoredData()  // ä¸€é”®æ¸…é™¤
```

#### `rateLimit.ts`
```typescript
// é€Ÿç‡é™åˆ¶ï¼ˆ1 request/secondï¼‰
canMakeRequest()          // æ˜¯å¦å¯å‘é€
getRemainingTime()        // å‰©ä½™ç­‰å¾…æ—¶é—´ï¼ˆç§’ï¼‰
updateLastRequestTime()   // æ›´æ–°æœ€åè¯·æ±‚æ—¶é—´
resetRateLimit()          // é‡ç½®ï¼ˆæ¸…é™¤æ•°æ®æ—¶ä½¿ç”¨ï¼‰
```

### 5. å›½é™…åŒ–è¯å…¸ (`src/locales/`)

#### è¯å…¸ç»“æ„
```json
{
  "app": { "title": "...", "subtitle": "..." },
  "section": { "connection": "...", "text": "...", ... },
  "field": { "apiKey": "...", "deviceId": "...", ... },
  "cta": { "probe": "...", "send": "...", ... },
  "status": { "idle": "...", "connecting": "...", ... },
  "toast": { "success": "...", ... },
  "error": {
    "400": { "title": "...", "message": "...", "suggestion": "..." },
    "403": { ... },
    ...
  },
  "info": { ... },
  "footer": { ... },
  "theme": { ... },
  "language": { ... }
}
```

## ğŸ”„ æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ
   â†“
page.tsx (çŠ¶æ€ç®¡ç†)
   â†“
â”œâ”€â†’ utils/api.ts (API è°ƒç”¨)
â”‚   â†“
â”‚   Dot å®˜æ–¹æœåŠ¡å™¨
â”‚   â†“
â”‚   è¿”å›å“åº”/é”™è¯¯
â”‚   â†“
â”œâ”€â†’ utils/storage.ts (ä¿å­˜åˆ° sessionStorage)
â”‚
â”œâ”€â†’ utils/rateLimit.ts (é€Ÿç‡æ§åˆ¶)
â”‚
â””â”€â†’ æ›´æ–°çŠ¶æ€
    â†“
    ç»„ä»¶é‡æ–°æ¸²æŸ“
    â†“
    UI æ›´æ–°
```

## ğŸ¨ æ ·å¼æ¶æ„

### CSS å˜é‡ç³»ç»Ÿ

```css
/* globals.css */
:root {
  --color-primary: #2563EB;
  --color-bg: #F8FAFC;
  --color-text: #0F172A;
  --radius: 12px;
  --spacing: 16px;
  /* ... */
}

[data-theme="dark"] {
  --color-bg: #0B0F1A;
  --color-text: #DCE3F0;
  /* ... */
}
```

### ç»„ä»¶æ ·å¼

- æ¯ä¸ªç»„ä»¶æœ‰ç‹¬ç«‹çš„ CSS æ–‡ä»¶
- ä½¿ç”¨ CSS å˜é‡ä¿æŒä¸€è‡´æ€§
- æ”¯æŒå“åº”å¼ï¼ˆ@mediaï¼‰
- æ˜ç¡®çš„ç±»åï¼ˆé¿å…å†²çªï¼‰

## ğŸ—ï¸ æ„å»ºæµç¨‹

```bash
npm run dev      # å¼€å‘æœåŠ¡å™¨ï¼ˆTurbopackï¼‰
npm run build    # ç”Ÿæˆé™æ€äº§ç‰©åˆ° out/
```

### æ„å»ºè¾“å‡º (`out/`)

```
out/
â”œâ”€â”€ index.html           # é¦–é¡µ
â”œâ”€â”€ _next/
â”‚   â”œâ”€â”€ static/          # é™æ€èµ„æºï¼ˆCSS, JSï¼‰
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

å¯ç›´æ¥éƒ¨ç½²åˆ°ï¼š
- Vercel / Netlify
- GitHub Pages
- ä»»æ„é™æ€æ‰˜ç®¡æœåŠ¡
- æœ¬åœ°æ–‡ä»¶æœåŠ¡å™¨ï¼ˆå¦‚ `npx serve out`ï¼‰

## ğŸ”§ æŠ€æœ¯é€‰å‹ç†ç”±

| æŠ€æœ¯ | ç†ç”± |
|------|------|
| Next.js 15 | æœ€æ–°ç‰ˆæœ¬ï¼ŒApp Routerï¼Œé™æ€å¯¼å‡ºæ”¯æŒ |
| TypeScript | ç±»å‹å®‰å…¨ï¼Œæ›´å¥½çš„å¼€å‘ä½“éªŒ |
| åŸç”Ÿ CSS | æ— éœ€é¢å¤–ä¾èµ–ï¼Œå®Œå…¨æ§åˆ¶æ ·å¼ |
| CSS å˜é‡ | ä¸»é¢˜åˆ‡æ¢ï¼Œå‡å°‘é‡å¤ä»£ç  |
| sessionStorage | ä¸´æ—¶å­˜å‚¨ï¼Œå…³é—­å³æ¸…é™¤ï¼Œç¬¦åˆéšç§è¦æ±‚ |
| æ— å¤–éƒ¨åº“ | å‡å°‘ä¾èµ–ï¼Œæå‡åŠ è½½é€Ÿåº¦å’Œå®‰å…¨æ€§ |

## ğŸ¯ è®¾è®¡åŸåˆ™

### First Principles
- æ ¸å¿ƒéœ€æ±‚ï¼šå‘ Dot è®¾å¤‡å‘é€æ–‡æœ¬
- æœ¬è´¨ï¼šæµè§ˆå™¨ â†’ API â†’ è®¾å¤‡

### YAGNI
- V0 åªå®ç° Text APIï¼Œä¸åš Image
- å•è®¾å¤‡ï¼Œä¸åšå¤šè®¾å¤‡ç®¡ç†
- ä¼šè¯å­˜å‚¨ï¼Œä¸åšæŒä¹…åŒ–

### KISS
- çŠ¶æ€é›†ä¸­åœ¨ `page.tsx`
- ç»„ä»¶æ— çŠ¶æ€ï¼Œçº¯å±•ç¤ºæˆ–å—æ§
- å·¥å…·å‡½æ•°å•ä¸€èŒè´£

### SOLID
- å•ä¸€èŒè´£ï¼šæ¯ä¸ªç»„ä»¶ã€å·¥å…·å„å¸å…¶èŒ
- å¼€æ”¾å°é—­ï¼šæ˜“äºæ‰©å±•ï¼ˆå¦‚æ·»åŠ  Image APIï¼‰

### DRY
- CSS å˜é‡å¤ç”¨
- i18n è¯å…¸ç»Ÿä¸€ç®¡ç†
- å·¥å…·å‡½æ•°é¿å…é‡å¤é€»è¾‘

## ğŸ“š æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°è¯­è¨€

1. åœ¨ `src/locales/` æ·»åŠ æ–°è¯å…¸æ–‡ä»¶ï¼ˆå¦‚ `ja-JP.json`ï¼‰
2. åœ¨ `useI18n.ts` çš„ `translations` å¯¹è±¡ä¸­å¼•å…¥
3. åœ¨ `Header.tsx` æ·»åŠ é€‰é¡¹

### æ·»åŠ æ–°ä¸»é¢˜

1. åœ¨ `globals.css` æ·»åŠ æ–°ä¸»é¢˜å˜é‡ï¼ˆå¦‚ `[data-theme="custom"]`ï¼‰
2. åœ¨ `useTheme.ts` çš„ç±»å‹å®šä¹‰ä¸­æ·»åŠ 
3. åœ¨ `Header.tsx` æ·»åŠ é€‰é¡¹

### æ·»åŠ æ–° API åŠŸèƒ½

1. åœ¨ `src/utils/api.ts` æ·»åŠ æ–°å‡½æ•°
2. åœ¨ `page.tsx` æ·»åŠ çŠ¶æ€å’Œå¤„ç†é€»è¾‘
3. åˆ›å»ºå¯¹åº”çš„ UI ç»„ä»¶
4. æ›´æ–° i18n è¯å…¸

---

æœ‰ç–‘é—®ï¼ŸæŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) æˆ–åˆ›å»º Issueã€‚

